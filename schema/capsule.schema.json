{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/derekwins88/Brain/schema/capsule.schema.json",
  "title": "Brain Capsule",
  "description": "Auditable, structured capsule for research statements and context.",
  "type": "object",
  "additionalProperties": false,
  "required": ["id", "kind", "title", "assumptions", "claim", "context", "status", "version", "created"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9-]{2,64}$",
      "description": "Stable id, kebab-case (e.g., brain-demo-0001)"
    },
    "kind": {
      "const": "capsule",
      "description": "Must be exactly 'capsule'."
    },
    "title": { "type": "string", "minLength": 3, "maxLength": 200 },
    "assumptions": {
      "type": "array",
      "minItems": 0,
      "items": { "type": "string", "minLength": 1 }
    },
    "claim": { "type": "string", "minLength": 1 },
    "context": {
      "type": "object",
      "additionalProperties": false,
      "required": ["refs"],
      "properties": {
        "refs": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        },
        "notes": { "type": "string" }
      }
    },
    "status": {
      "type": "string",
      "enum": ["draft", "frozen", "superseded"]
    },
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
      "description": "SemVer version of the capsule content (e.g., 0.1.0)"
    },
    "created": { "type": "string", "format": "date-time" },
    "updated": { "type": "string", "format": "date-time" },
    "authors": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["name"],
        "properties": {
          "name": { "type": "string", "minLength": 1 },
          "email": { "type": "string", "format": "email" },
          "orcid": { "type": "string", "pattern": "^\\d{4}-\\d{4}-\\d{4}-\\d{3}[\\dX]$" }
        }
      }
    },
    "provenance": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "derivedFrom": {
          "type": "array",
          "items": { "type": "string" }
        },
        "tools": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    "hash": {
      "type": "string",
      "pattern": "^[a-f0-9]{64}$",
      "description": "Optional SHA-256 of canonicalized capsule content."
    }
  }
}
